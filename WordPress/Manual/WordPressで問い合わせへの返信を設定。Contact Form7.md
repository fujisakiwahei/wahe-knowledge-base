# WordPressで問い合わせへの返信を設定。Contact Form7

タイプ: フロー
技術・ツール: WordPress

### 前提条件

- WordPress サイトが稼働していること
- Contact Form 7 プラグインが有効化されていること
- WP Mail SMTP などの SMTP プラグインを利用してメール送信を行うこと

---

### 1. レンタルサーバで自動返信用メールアドレスを作成する

1. 契約しているレンタルサーバの管理画面にログインする。
2. 「メールアドレス作成」画面を開く。
3. 自動返信専用のメールアドレス（例：[`noreply@example.com`](mailto:noreply@example.com)）を新規作成する。
4. メールボックスの容量や転送設定など、必要に応じてサーバ側で設定しておく。

---

### 2. Contact Form 7 のメール送信元アドレスを設定する

1. 対象フォームの「メール」タブを開く。
2. 「送信先(To)」には、お問い合わせを受信したい自分（またはクライアント）のメールアドレスを設定する。
3. 「送信元(From)」には、**サーバで作成した自動返信用メールアドレス**（例：[`noreply@example.com`](mailto:noreply@example.com)）を指定する。
    - 例：[`noreply@example.com`](mailto:noreply@example.com)
4. 件名・メッセージ本文をサイトのトンマナに合わせて整える。
    - [Contact Form7のhtmlとcssから自動応答メール設定まで](Contact%20Form7%E3%81%AEhtml%E3%81%A8css%E3%81%8B%E3%82%89%E8%87%AA%E5%8B%95%E5%BF%9C%E7%AD%94%E3%83%A1%E3%83%BC%E3%83%AB%E8%A8%AD%E5%AE%9A%E3%81%BE%E3%81%A7%202bcdf78c372e803190d0c7a7899e3066.md) のプロンプトを使用することで、ここと次の工程をAIが生成可能。

---

### 3. Contact Form 7 の「メール1」「メール2」を設定する

Contact Form 7 では、以下のように使い分ける。

- **メール1**：サイト運営者側への通知メール
- **メール2**：問い合わせを送信したユーザーへの自動返信メール

### メール1（運営者通知）

1. 「メール」タブの内容を、運営者への通知内容として設定する。
2. 送信先を運営者メールアドレスに、本文には問い合わせ内容が分かるようにタグを挿入する。

### メール2（ユーザー自動返信）

1. 「メール2を使用」にチェックを入れる。
2. 「送信先(To)」に、フォームで取得したユーザーのメールアドレスフィールド（例：`[your-email]`）を指定する。
3. 「送信元(From)」は **サーバで作成した自動返信用アドレス** を指定する。

---

### 5. WP Mail SMTP を設定する

1. WordPress 管理画面で「WP Mail SMTP」の設定画面を開く。
2. メール送信元アドレスとして、**サーバで作成したメールアドレス**を設定する。
3. SMTP 情報（ホスト名・ポート・暗号化方式・ユーザー名・パスワード）を、レンタルサーバのマニュアルに従って入力する。
    
    <aside>
    
    **参考: https://support.conoha.jp/w/mailclient/**
    
    </aside>
    
4. 「テストメール送信」で実際にメールが届くか確認する。

---

### 6. DKIM・SPF・DMARC を設定する（迷惑メール対策）

問い合わせメールが迷惑メール扱いされないように、DNS レコードを設定する。

1. ドメインを管理しているサービス（サーバ、または DNS 管理サービス）の管理画面を開く。
2. 提供されている手順に従い、以下を追加／設定する。
    - SPF レコード（TXT）
    - DKIM レコード（TXT）
    - DMARC レコード（TXT）
3. 反映まで時間がかかる場合があるため、数時間～1日ほど様子を見る。
4. その後、実際に問い合わせフォームから送信して、
    - 受信トレイに届くか
    - 迷惑メールフォルダに振り分けられていないか
    
    を確認する。
    

<aside>

**参考:** https://www.aboutwp.net/conoha-wing-spf-dkim-dmarc/

</aside>

---

### 7. 動作テスト

1. フロント側の問い合わせフォームから、テスト送信を行う。
2. 以下を確認する。
    - 運営者宛ての通知メールが正しく届いているか（メール1）
    - ユーザー宛ての自動返信メールが正しく届いているか（メール2）
    - 表示名・件名・本文・差出人情報が想定どおりか
3. 複数のメールサービス（Gmail、キャリアメールなど）でもテストしておくと安心。